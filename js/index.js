"use strict";function CountDown(){this.time=60,this.init=function(e){var t,r=e instanceof Object?e:document.getElementById(e),o=this;this.time<0?(clearTimeout(t),this.time=60,r.disabled=!1,r.innerText="获取验证码"):(r.disabled=!0,r.innerText="再次("+this.time+"s)",this.time--,t=setTimeout(function(){o.init(e)},1e3))}}var getAuthCode=function(e){function t(e){e.src="/Kkzc/static/images/kaptcha.jpg?d="+Date.now()+"&p="+i}function r(e,t){var r='<div class="c-content" style="position:absolute;top:50%;left:50%;width:70%;margin:-4.026667rem 0 0 -35%;background-color:#fff;border-radius:4px;text-align:center;padding:0.5rem 0 0;"z-index:2002;>        <div style="display:block;width:5rem;height:2rem;line-height:0.66rem;border:0;margin:0 auto;padding:0;position:relative;font-size:0.4rem;">验证码加载中...        <img src="/Kkzc/static/images/kaptcha.jpg?p='+t+'" style="display:block;position:absolute;left:0;top:0;margin:0 auto;width:5rem;height:2rem;" class="codeImg"/></div>        <input type="text" class="authcode" placeholder="请输入验证码" style="display:inline-block;width: 3rem;height:1.1rem;line-height:0.53rem;padding:0;border-radius:2px;padding-left:0.2rem;font-size: 0.4rem;border:0;border:1px solid #C5C5C5;margin:0.4rem 0 0.5rem;"/>        <button class="ok" style="display:inline-block;width:2.4rem;height:1.18rem;padding:0;line-height: 0.5rem;font-size:0.4rem;border:0;border:1px solid #C5C5C5;background-color:#ddd;border-radius: 2px;cursor:pointer;">确定</button>      </div>',o=document.createElement("div");o.className="c-authcode",o.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.8);font-size:0.3rem;color:#000;z-index:2000;",o.innerHTML=r,c.appendChild(o)}function o(){var r=document.querySelector(".c-authcode .ok"),o=document.querySelector(".c-authcode .authcode"),n=document.querySelector(".c-authcode img"),a=document.querySelector(".c-authcode");r.onclick=function(){if(null==o.value||""==o.value)return alert("请输入验证码"),!1;var a=o.value.replace(s,"");e.data.kaptcha=a,e.type=e.type||"GET",r.setAttribute("disabled","disabled"),r.innerText="请求中",u({url:e.url,method:e.type,data:e.data,success:function(a){r.removeAttribute("disabled"),r.innerText="确定",t(n),o.value="",e.callback&&e.callback({data:JSON.parse(a),status:"success",remove:d})},error:function(a){r.removeAttribute("disabled"),r.innerText="确定",t(n),o.value="",e.callback&&e.callback({data:JSON.parse(a),status:"error",remove:d})}})},e.update=function(){var e=document.querySelector(".c-authcode img");e.style.borderColor="#FF0303",t(e)},n.onclick=function(){t(this)};var i=function(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent&&(e["e"+t+r]=r,e.attachEvent("on"+t,function(o){e["e"+t+r](o)}))},c=function(e){e.target=e.srcElement||e.target,"c-authcode"===e.target.className&&(this.style.display="none",o.value="")};i(a,"click",c)}function n(e){var t="107,107,122,99,50,48,49,52".split(","),r="";for(l=0;l<t.length;l++)r+=String.fromCharCode(t[l]);return md5(e+r)}var a,i,c=document.body,s=/^\s+|\s+$/g,e=e,d=function(){if(document.querySelector(".c-authcode")){var e=document.querySelector(".c-authcode"),r=document.querySelector(".c-authcode .authcode"),o=document.querySelector(".c-authcode .codeImg");e.style.display="none",r.value="",t(o)}},u=function(){var e=function(){return"XMLHttpRequest"in window?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")}}(),t=function(e){var t="";for(var r in e)t+=r+"="+e[r]+"&";return t.slice(0,-1)},r=function(r){var o=this,n=e();o.url=r.url,o.type=r.type||"responseText",o.method=r.method||"GET",o.async=r.async||!0,o.data=r.data||{},o.complete=r.complete||function(){},o.success=r.success||function(){},o.error=r.error||function(e){console.warn(o.url+"->status:"+e+"error!")},o.abort=n.abort,o.setData=function(e){for(var t in e)o.data[t]=e[t]},o.send=function(){var e,r=t(o.data),a=!1,i=o.async,c=o.complete,s=o.method,d=o.type;"GET"===s&&(o.url+="?"+r,a=!0),n.open(s,o.url,i),a||(n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e=r),n.onreadystatechange=i?function(){4==n.readyState&&(c(),200==n.status?o.success(n[d]):o.error(n.status))}:null,n.send(e),i||(c(),o.success(n[d]))},o.url&&o.send()};return function(e){return new r(e)}}();for(var l in e.data)if(11==e.data[l].toString().length){i=e.data[l],a=l,e.data.k=n(i);break}document.querySelector(".c-authcode")?(document.querySelector(".c-authcode").style.display="block",o()):(r(a,i),o())},dom={tel:$("#tel"),cap:$("#cap"),getCap:$("#getCap"),submit:$(".submit"),errTip:$(".err-tip")},errMsg=["请输入正确的手机号码","请输入正确的验证码"],regEx={tel:/^1[3|4|5|7|8][0-9]\d{8}$/,cap:/\d{6}$/},showErr=function(e){dom.errTip.text(e),dom.errTip.addClass("shake"),setTimeout(function(){dom.errTip.removeClass("shake")},600)},hideErr=function(){dom.errTip.text(""),dom.errTip.removeClass("shake")};dom.submit.on("click",function(){dom.tel.val(),dom.cap.val()});var $inputs=$("input[type=tel]"),$resets=$(".input-wrapper i");$inputs.on("focus",function(e){var t=$(e.target);t.siblings("i").addClass("show-reset"),hideErr()}),$resets.on("click",function(e){var t=$(e.target),r=t.siblings("input[type=tel]");t.removeClass("show-reset"),r.val("")}),dom.getCap.on("click",function(){var e=$.trim(dom.tel.val());return e&&regEx.tel.test(e)?void getAuthCode({url:"/Kkzc/userapi/authcode/1.do",data:{p:e},callback:function(e){var t=e;e.data;"success"===t.status?(t.remove(),(new CountDown).init(dom.getCap[0])):(t.remove(),alert("网络出错，请检查网络！"))}}):void showErr(errMsg[0])}),dom.submit.on("click",function(){var e=$.trim(dom.tel.val()),t=$.trim(dom.cap.val());return e&&regEx.tel.test(e)?t&&regEx.cap.test(t)?void 0:void showErr(errMsg[1]):void showErr(errMsg[0])});
//# sourceMappingURL=../../map/cxbshare/js/index.js.map
